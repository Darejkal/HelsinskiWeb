<!DOCTYPE html>
<html lang="en">


<head>
    <script text="text/javascript">
        if (JSON.parse(localStorage.getItem('user')) ) {
            console.log("TRUE1")
            window.location.href = "./dashboard.html"
        }
    </script>
    <meta charset="utf-8" />
    <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png">
    <link rel="icon" type="image/png" href="../assets/img/favicon.png">
    <title>
        Helsinski
    </title>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />

    <!-- Nucleo Icons -->
    <link href="../assets/css/nucleo-icons.css" rel="stylesheet" />
    <link href="../assets/css/nucleo-svg.css" rel="stylesheet" />

    <!-- Font Awesome Icons -->
    <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
    <link href="../assets/css/nucleo-svg.css" rel="stylesheet" />
    <link id="pagestyle" href="../assets/css/soft-ui-dashboard.min.css" rel="stylesheet" />

</head>

<body
    class="container-fluid vh-100 d-flex flex-column align-items-center justify-content-center border-radius-lg flex-wrap bg-gray-100">
    <h1 class="text-primary">Helsinski project</h1>
    <div class="card m-3">
        <div class="card-body">
            <h6 id="textWarning" class="text-danger"></h6>
        
            <form onsubmit="onFormSubmit();return false;"
                class="container-fluid d-flex flex-column align-items-center justify-content-center">
                <div class="form-group">
                    <label for="example-email-input" class="form-control-label">Email</label>
                    <input class="form-control" type="email" placeholder="helsinski@example.com" id="inputEmail">
                </div>

                <div class="form-group">
                    <label for="example-password-input" class="form-control-label">Password</label>
                    <input class="form-control" type="password" placeholder="password" id="inputPassword">
                </div>
                <input type="submit" class="btn btn-primary" value="login"  />
            </form>
        </div>
    </div>
    <!-- Core JS Files   -->
    <script src="../assets/js/core/bootstrap.bundle.min.js"></script>

    <script src="../assets/js/plugins/chartjs.min.js"></script>
    <script type="text/javascript">

        function onFormSubmit() {
            fetch("https://sv1.h23.zedbuilder.com/login", {
                method: "POST", // *GET, POST, PUT, DELETE, etc.
                mode: "cors", // no-cors, *cors, same-origin
                cache: "no-cache", // *default, no-cache, reload, force-cache, only-if-cached
                credentials: "same-origin", // include, *same-origin, omit
                headers: {
                    "Content-Type": "application/json",
                    // 'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: JSON.stringify({
                    username: document.getElementById("inputEmail").value,
                    password: document.getElementById("inputPassword").value
                }), // body data type must match "Content-Type" header
            }).then(v => {
                if (v.ok) {
                    return v.text()
                } 
                throw new Error('Something went wrong');
            }
            ).then(res => {
                    localStorage.setItem('user', JSON.stringify(res));
                    window.location.href="./dashboard.html"
            })
            // .catch((error)=>{
            //     console.log("Error");
            //     document.getElementById("textWarning").innerHTML = "Error occured";
            // })
        }
    </script>

</body>

</html>